# ğŸ¢ WE Accounting & Tax AI
## System Overview for CEO/CTO

---

# ğŸ“Š High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                                     â”‚
â”‚                         ğŸ‘¥ USERS                                    â”‚
â”‚                    (Browser / Mobile)                               â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ğŸ“± FRONTEND (React)                            â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Login   â”‚ â”‚ Clients  â”‚ â”‚Documents â”‚ â”‚ Reports  â”‚ â”‚ Settings â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚ HTTP (JWT)
                                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      âš™ï¸ BACKEND (Express.js)                        â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚                    ğŸ” AUTH MIDDLEWARE                        â”‚   â”‚
â”‚  â”‚              JWT Verification + Role Check                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚  Auth  â”‚ â”‚Clients â”‚ â”‚  Docs  â”‚ â”‚   GL   â”‚ â”‚Analyze â”‚           â”‚
â”‚  â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚
â”‚  â”‚ Staff  â”‚ â”‚ Assets â”‚ â”‚  Bank  â”‚ â”‚ Rules  â”‚ â”‚ Tasks  â”‚           â”‚
â”‚  â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚ â”‚ Routes â”‚           â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â”‚                                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚               â”‚               â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”       â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
        â–¼               â–¼       â–¼       â–¼               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL  â”‚ â”‚ File Storage â”‚ â”‚  Gemini AI   â”‚ â”‚Activity Logs â”‚
â”‚   Database   â”‚ â”‚ Local Disk   â”‚ â”‚   (Cloud)    â”‚ â”‚  (Audit)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ”„ Core Business Workflows

## 1. Document Processing Workflow

```
ğŸ“¤ Upload Invoice/Receipt
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ AI OCR  â”‚â—„â”€â”€â”€â”€ Gemini API reads document
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      Extracts: vendor, amount, date, items
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ Review  â”‚â—„â”€â”€â”€â”€ Staff reviews AI results
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜      Can edit if needed
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
    â–¼         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”
â”‚Approveâ”‚ â”‚Reject â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚Post Journal â”‚â—„â”€â”€â”€â”€ Auto-generate accounting entries
â”‚   Entry     â”‚      Debit/Credit balanced
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Trial     â”‚â—„â”€â”€â”€â”€ Real-time balance calculation
â”‚  Balance    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 2. User Role Hierarchy

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚      ADMIN      â”‚
                    â”‚   Full Access   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â–¼               â–¼               â–¼
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ MANAGER  â”‚    â”‚ SENIOR   â”‚    â”‚ACCOUNTANTâ”‚
      â”‚All Clientsâ”‚   â”‚ Assigned â”‚    â”‚ Assigned â”‚
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚ Clients  â”‚    â”‚ Clients  â”‚
                      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Role Permissions:**

| Action | Admin | Manager | Senior | Accountant |
|--------|:-----:|:-------:|:------:|:----------:|
| Manage Staff | âœ… | âŒ | âŒ | âŒ |
| All Clients | âœ… | âœ… | âŒ | âŒ |
| Create Client | âœ… | âœ… | âŒ | âŒ |
| Upload Docs | âœ… | âœ… | âœ… | âœ… |
| Approve Docs | âœ… | âœ… | âœ… | âŒ |
| Post GL | âœ… | âœ… | âœ… | âŒ |
| View Reports | âœ… | âœ… | âœ… | âœ… |

---

# ğŸ¤– AI/OCR Analysis Details

## What AI Extracts:

| Field | Description | Example |
|-------|-------------|---------|
| `doc_type` | Document type | invoice, receipt, payment |
| `vendor_name` | Seller name | à¸šà¸£à¸´à¸©à¸±à¸— ABC à¸ˆà¸³à¸à¸±à¸” |
| `vendor_tax_id` | Tax ID | 0105555000001 |
| `document_number` | Invoice number | INV-2024-0001 |
| `document_date` | Issue date | 2024-12-15 |
| `subtotal` | Before VAT | 10,000.00 |
| `vat_amount` | 7% VAT | 700.00 |
| `vat_rate` | VAT percentage | 7 |
| `total_amount` | Grand total | 10,700.00 |
| `wht_applicable` | WHT applies? | true |
| `wht_rate` | WHT percentage | 3 |
| `wht_amount` | WHT amount | 300.00 |
| `journal_lines` | Accounting entries | [Debit/Credit pairs] |

## WHT Rules (Thai Standard):

| Expense Type | WHT Rate |
|--------------|----------|
| Transportation | 1% |
| Advertising | 2% |
| Professional Services | 3% |
| Rent | 5% |

---

# ğŸ“Š Database Schema Summary

## 9 Core Tables:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    STAFF    â”‚ â”€â”€â”€ Users (admin, accountant)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ email       â”‚
â”‚ name        â”‚
â”‚ role        â”‚
â”‚ assigned_   â”‚
â”‚   clients[] â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   CLIENT    â”‚ â”€â”€â”€ Company/Business accounts
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ name        â”‚
â”‚ tax_id      â”‚
â”‚ vat_status  â”‚
â”‚ wht_status  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  DOCUMENT   â”‚ â”€â”€â”€ Uploaded invoices/receipts
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ client_id   â”‚â”€â”€â†’ CLIENT
â”‚ filename    â”‚
â”‚ ai_data     â”‚ (JSON from AI)
â”‚ status      â”‚
â”‚ amount      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GL_ENTRY   â”‚ â”€â”€â”€ Journal entries
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ client_id   â”‚â”€â”€â†’ CLIENT
â”‚ date        â”‚
â”‚ account_codeâ”‚
â”‚ debit       â”‚
â”‚ credit      â”‚
â”‚ period      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚BANK_TRANS   â”‚ â”€â”€â”€ Bank statement lines
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ client_id   â”‚â”€â”€â†’ CLIENT
â”‚ date        â”‚
â”‚ amount      â”‚
â”‚ status      â”‚ (unmatched/matched/reconciled)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚FIXED_ASSET  â”‚ â”€â”€â”€ Equipment, vehicles, etc.
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ client_id   â”‚â”€â”€â†’ CLIENT
â”‚ name        â”‚
â”‚ purchase_   â”‚
â”‚   value     â”‚
â”‚ depreciationâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚VENDOR_RULE  â”‚ â”€â”€â”€ Auto-categorization rules
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ vendor_     â”‚
â”‚   pattern   â”‚ (regex)
â”‚ default_    â”‚
â”‚   account   â”‚
â”‚ wht_rate    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    TASK     â”‚ â”€â”€â”€ Work assignments
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ client_id   â”‚â”€â”€â†’ CLIENT
â”‚ assignee_id â”‚â”€â”€â†’ STAFF
â”‚ title       â”‚
â”‚ status      â”‚
â”‚ due_date    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ACTIVITY_LOG â”‚ â”€â”€â”€ Audit trail
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ id          â”‚
â”‚ action      â”‚
â”‚ entity_type â”‚
â”‚ user_id     â”‚
â”‚ timestamp   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

# ğŸ’° Business Value Metrics

## Cost Savings

```
Monthly Cost Comparison:
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â˜ï¸ CLOUD (Firebase)           ğŸ–¥ï¸ LOCAL VM
                              
   Firestore:    $50             VPS:      $30
   Storage:      $30             Database: $20
   Auth:         $20             â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Functions:    $50             Subtotal: $50
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€               
   Subtotal:    $150             
                                  
   + Gemini:     $50             + Gemini:  $50
   â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•              â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   TOTAL:       $200             TOTAL:    $100
                                  
   
   ğŸ’° SAVINGS: $100/month = $1,200/year
```

## Efficiency Gains

| Manual Process | With AI System |
|----------------|----------------|
| Data entry: 5 min/invoice | 30 seconds/invoice |
| Error rate: 5% | Error rate: <1% |
| Review time: 10 min | Review time: 2 min |
| Report generation: 30 min | Real-time |

---

# ğŸ”’ Security Features

1. **Authentication:** JWT tokens (7-day expiry)
2. **Password:** bcrypt hashing (12 rounds)
3. **Rate Limiting:** 100 requests/minute
4. **CORS:** Whitelist-only origins
5. **Headers:** Helmet.js security headers
6. **Data Isolation:** Client data separated
7. **Audit Trail:** All actions logged

---

# ğŸš€ Deployment Ready

- âœ… Docker containers configured
- âœ… PostgreSQL database ready
- âœ… Automated backup scripts
- âœ… Health monitoring
- âœ… SSL-ready Nginx config
- âœ… Seed data with demo accounts

---

*WE Accounting & Tax AI - System Overview*
*Version 1.0 | December 2024*
